<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>attack-workbench-frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">attack-workbench-frontend documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">













<ol class="breadcrumb">
  <li>Interfaces</li>
  <li
  >
  CollectionIndexViewConfig</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/views/stix/collection/collection-index/collection-index-view/collection-index-view.component.ts</code>
        </p>




        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#index" 
>
                                            index
                                        </a>
                                </li>
                                <li>
                                        <a href="#show_actions" 
>
                                            show_actions
                                        </a>
                                </li>
                                <li>
                                        <a href="#show_title" 
>
                                            show_title
                                        </a>
                                </li>
                                <li>
                                        <a href="#subscribed_collections" 
>
                                            subscribed_collections
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="index"></a>
                                        <span class="name "><b>index</b>
                                            <a href="#index">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>index:         <code><a href="../classes/CollectionIndex.html" target="_self" >CollectionIndex</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../classes/CollectionIndex.html" target="_self" >CollectionIndex</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="show_actions"></a>
                                        <span class="name "><b>show_actions</b>
                                            <a href="#show_actions">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>show_actions:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="show_title"></a>
                                        <span class="name "><b>show_title</b>
                                            <a href="#show_title">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>show_title:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="subscribed_collections"></a>
                                        <span class="name "><b>subscribed_collections</b>
                                            <a href="#subscribed_collections">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>subscribed_collections:     <code>any[]</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>any[]</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, EventEmitter, Input, OnInit, Output, ViewEncapsulation } from &#x27;@angular/core&#x27;;
import { MatDialog } from &#x27;@angular/material/dialog&#x27;;
import { Router } from &#x27;@angular/router&#x27;;
import { Role } from &#x27;src/app/classes/authn/role&#x27;;
import { CollectionIndex, CollectionReference, CollectionVersion } from &#x27;src/app/classes/collection-index&#x27;;
import { ConfirmationDialogComponent } from &#x27;src/app/components/confirmation-dialog/confirmation-dialog.component&#x27;;
import { MarkdownViewDialogComponent } from &#x27;src/app/components/markdown-view-dialog/markdown-view-dialog.component&#x27;;
import { AuthenticationService } from &#x27;src/app/services/connectors/authentication/authentication.service&#x27;;
import { RestApiConnectorService } from &#x27;src/app/services/connectors/rest-api/rest-api-connector.service&#x27;;

@Component({
  selector: &#x27;app-collection-index-view&#x27;,
  templateUrl: &#x27;./collection-index-view.component.html&#x27;,
  styleUrls: [&#x27;./collection-index-view.component.scss&#x27;],
  encapsulation: ViewEncapsulation.None
})
export class CollectionIndexViewComponent implements OnInit {
    @Input() config: CollectionIndexViewConfig;
    @Output() onCollectionsModified &#x3D; new EventEmitter();
    public get isAdmin(): boolean { return this.authenticationService.isAuthorized([Role.ADMIN]); }

    constructor(private authenticationService: AuthenticationService, private restAPIConnector: RestApiConnectorService, private dialog: MatDialog, private router: Router) { }

    ngOnInit(): void {
    }

    public get showActions(): boolean {
        return !this.config.hasOwnProperty(&quot;show_actions&quot;) || this.config.show_actions;
    }

    public showReleaseNotes(version: CollectionVersion, collection: CollectionReference) {
        this.dialog.open(MarkdownViewDialogComponent, {
            data: {
                markdown: version.release_notes,
                title: &#x60;${collection.name} v${version.version.toString()} Release Notes&#x60;
            }
        })
    }

    public versionDownloaded(version: CollectionVersion, ref: CollectionReference): boolean {
        let result &#x3D; this.config.subscribed_collections.some(subscribed &#x3D;&gt; {
            let matcher &#x3D; &#x60;${ref.id}@${version.modified}&#x60;;
            return matcher &#x3D;&#x3D; subscribed;
        });
        return result;
    }

    /**
     * Subscribe to the given collection reference
     * @param {CollectionReference} collectionRef
     * @memberof CollectionIndexViewComponent
     */
    public subscribe(collectionRef: CollectionReference) {
        // confirm that the user actually wants to do this
        let prompt &#x3D; this.dialog.open(ConfirmationDialogComponent, {
            maxWidth: &quot;35em&quot;,
            data: { 
                message: &#x60;## Subscribe to ${collectionRef.name}?\n\n Subscribing will download the most recent version of ${collectionRef.name}. New versions of the collection will automatically download when they are released.&#x60;,
                yes_suffix: &quot;keep the collection updated&quot;
            }
        });
        let subscription &#x3D; prompt.afterClosed().subscribe({
            next: (result) &#x3D;&gt; {
                // if they clicked yes, subscribe to the collection
                if (result) {
                    let subscribedCollections &#x3D; new Set&lt;string&gt;(this.config.index.workspace.update_policy.subscriptions);
                    let subscriptionID &#x3D; collectionRef.id; //id to toggle
                    // add subscription
                    subscribedCollections.add(subscriptionID);
                    // set in object
                    this.config.index.workspace.update_policy.subscriptions &#x3D; Array.from(subscribedCollections)
                    // PUT result to backend
                    this.restAPIConnector.putCollectionIndex(this.config.index, &#x60;subscribed to ${collectionRef.name}&#x60;).subscribe(() &#x3D;&gt; {
                        this.onCollectionsModified.emit()
                    });
                }
            },
            complete: () &#x3D;&gt; { subscription.unsubscribe(); } //prevent memory leaks
        })
    }

    public unsubscribe(collectionRef: CollectionReference) {
         // confirm that the user actually wants to do this
         let prompt &#x3D; this.dialog.open(ConfirmationDialogComponent, {
            maxWidth: &quot;35em&quot;,
            data: { 
                message: &#x60;## Unsubscribe from ${collectionRef.name}?\n\n Unsubscribing will mean you won&#x27;t automatically receive updates to ${collectionRef.name}. Previously downloaded versions of this collection will **not** be deleted.&#x60;,
                yes_suffix: &quot;unsubscribe&quot;
            }
        });
        prompt.afterClosed().subscribe(result &#x3D;&gt; {
            // if they clicked yes, subscribe to the collection
            if (result) {
                let subscribedCollections &#x3D; new Set&lt;string&gt;(this.config.index.workspace.update_policy.subscriptions);
                let subscriptionID &#x3D; collectionRef.id; //id to toggle
                // remove subscription
                subscribedCollections.delete(subscriptionID);
                // set in object
                this.config.index.workspace.update_policy.subscriptions &#x3D; Array.from(subscribedCollections)
                // PUT result to backend
                this.restAPIConnector.putCollectionIndex(this.config.index, &#x60;unsubscribed from ${collectionRef.name}&#x60;).subscribe(() &#x3D;&gt; {
                    this.onCollectionsModified.emit()
                });
            }
        })
    }

    public removeIndex() {
        // confirm that the user actually wants to do this
        let prompt &#x3D; this.dialog.open(ConfirmationDialogComponent, {
            maxWidth: &quot;35em&quot;,
            data: { 
                message: &quot;Are you sure you want to remove the collection index?&quot;,
                yes_suffix: &quot;delete it&quot;
            }
        });
        let promptSubscription &#x3D; prompt.afterClosed().subscribe({
            next: result &#x3D;&gt; {
                // if they clicked yes, delete the index
                if (result) {
                    let subscription &#x3D; this.restAPIConnector.deleteCollectionIndex(this.config.index.collection_index.id).subscribe({
                        next: () &#x3D;&gt; { this.onCollectionsModified.emit(); },
                        complete: () &#x3D;&gt; { subscription.unsubscribe(); } //prevent memory leaks
                    });
                }
            },
            complete: () &#x3D;&gt; { promptSubscription.unsubscribe() } //prevent memory leaks
        })
    }

    public onVersionClick(version: CollectionVersion, ref: CollectionReference) {
        if (this.versionDownloaded(version, ref)) { //view prior import
            this.router.navigate([&#x60;/collection/${ref.id}/modified/${version.modified.toISOString()}&#x60;]);
        } else { // go to download page
            if (this.isAdmin) this.router.navigate([&quot;/collection/import-collection&quot;], {queryParams: { &quot;url&quot;: encodeURIComponent(version.url) }})
        }
    }


}
export interface CollectionIndexViewConfig {
    // the index to show
    index: CollectionIndex;
    // &quot;id@modified&quot; for every subscribed collection. 
    // Used to determine if the given collection versions have been imported already
    subscribed_collections: any[];
    // default false. If true, show the collection title in the component
    show_title: boolean;
    // default true. If false, hides subscribe actions from the component
    show_actions: boolean;
}</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'CollectionIndexViewConfig.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
